# Survival

The first thing we are interested in is setting a baseline for the explanatory variables $\textbf{x}$. Where $\textbf{x}$ becomes the zero vector $\textbf{0}$. Eg. $\textbf{x} = (0,0,0...,0)$. 

It is very common for age to be standardised around some age of interest. Eg 50, so all ages would be given as 5, -10, etc which equates to 55 and 40.

The two common methods are :

- Accelarated Failure Time (AFT)
- Proportional Hazards (PH)

## AFT

### Two Group Example

In the simplests case we model survival times $T$ as a random variable. But with two groups we want to model them both as seperate RVs. Where the baseline RV is $T_0$ and the treatment (or other covariate) is given by $T_1$. As we now have times we can therefore model survivor functions $S$. However in AFTs we don't want $S_0$ and $S_1$ we want a single survivor function that is scaled.

We therefore look to the following:

$\text{Group 0 :   } S(t ; x_i=0) = P(T_0>t) = S_0(t))$
$\text{Group 1 :   } S(t ; x_i=1) = P(T_1>t) = P(\frac{T_0}{\psi}> t) = P(T_0>\psi t) = S_0(\psi t))$

So $\psi$ "accelrates time" and hence AFT and so the RVs are related by $T_1 = \frac{T_0}{\psi}$ and so $S_1(t) = S_0(\psi t)$.

Thinking back to graphing, any multiplier of a function value is a stretch in x, whose magnitude is the reciprical. So a $\psi >1$ will shrink survival time by $\frac{1}{\psi}$ and a $\psi <1$ will extend survival time.

So $\psi >1$ accelrates time for the patient (so they are more likely to die faster). Less than one Deaccelerates!

> Scale factor is $\frac{1}{\psi}$ , less than 1 means better survival times for the patient

So $\psi$ is a function of $\textbf{x}$, all of our covariates, which determine the "acceleration"

### Generalising to two groups

Instead of now having a $\psi$ to turn on and off we now require $\psi(\textbf{x})$ so that we can create a scaling factor for each individual. We therefore assume that (Where $S_0$ is $S(t)$ at the baseline consitions where $\textbf{x} = \textbf{0}$):

$S(t;\textbf{x}) = S_0(t\psi(\textbf{x}))$

From this it can be shown that the following are true:

$f(t;\textbf{x}) = f_0(t\psi(\textbf{x}))\psi(\textbf{x})$

$h(t;\textbf{x}) = h_0(t\psi(\textbf{x}))\psi(\textbf{x})$

This can be derived by showing that that $t$ being multiplie by $\psi$ and has $S_0$ applied to it as a function. We know the relationship between the survival function and the density fuinction. $S(t) = 1- F(t)$ differentiatiing we get negative density function. A function of a function, means that we need to use the chain rul and therefore gets the above. From the desnity we can get the hazard. TODO : Write out derivation. More details can be found at 25mins, 8/12. 

So again:
$T = \frac{T_0}{\psi(\textbf{x})}$

We are yet to define $\psi(\textbf{x})$ but tow conditions must be met:

- $\psi(\textbf{x})\geq 0$, so cannot have a negative time
- $\psi(\textbf{0}) = 1$, so that the basline has no strethcing effects. 

From this a naturual choice is (it could be any functiion though):

${\psi(\textbf{x})} = \exp(-\beta'\textbf{x})$

This gives us our parameters, but excludes the intercept terms. Recalling $T = \frac{T_0}{\psi(\textbf{x})}$ then 

$E[T] = \exp(\beta'\textbf{x})E[T_0]$

If $\beta_i x_i$ is positive then the expected survival time increases (good fro patient)

### Exponetial Case

Using the above we can therefore start to create an exponential AFT. We already know that for the exponential distribution:

Property| equation | AFT
-----|-----|----
$S(t)_0$|$e^{-\lambda t}$ | $S(t;\textbf{x}) = \exp(-\lambda t e^{-\beta'\textbf{x}})$
$h(t)_0$ | $\lambda$ | $\lambda e^{-\beta'\textbf{x}}$
$f(t)_0$|$\lambda e^{-\lambda t}$ | $\lambda e^{-\beta'\textbf{x}} \exp(-\lambda t e^{-\beta'\textbf{x}})$

So if $\textbf{x}_i$ is a p dimensional vector of explanatory variables then we ca n by MLE find p+1 parameters $(\lambda, \beta_1, \beta_2...\beta_p)$.

MLE is found by usual method, get derivative, set to 0, solve iteratively. $\hat{\lambda}$ and $\hat{\beta}$ are found any by the asymptopic properties of the MLE we know that:

$\hat{\lambda} \sim N(\lambda, \text{Var}(\hat{\lambda}))$

We can obtain $\text{Var}(\hat{\lambda}))$ from the expected/observed stuff covered in chapter 3 (TODO: find this out!)

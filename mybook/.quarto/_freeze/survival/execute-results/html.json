{
  "hash": "87a36ca2014407f90f4933490745b0be",
  "result": {
    "markdown": "# Survival\n\nWith survival analysis we aim to model lifetimes or populations. Survival analysis is unique as it aims to include censoring.\n\n## Chapter 1 - Intro\n\nWe are interested in two types of cencoring\n\n- right : The failure occurs after a set time, died after trial\n- left : The failure occurs before the observations begin, died before trial starts\n\nThe fundamental probaility theory required is as follows\n\n### Distribution Function\n\nLet $T$ be the failure time, where $T>0$. Then as expected the distribution function is:\n\n$F(t) = P(T\\leq t)$\n\nAnd therefore the probability density is:\n\n$f(t) = F'(t)$\n\nAnd so\n\n$F(t) = \\int_0^tf(u)du$\n\n\n### Survivor Function\n\nGenerally we are interested in whether someone will survive longer than a certain time. So:\n\n$S(t) = P(T\\geq t) = 1 - F(t) = \\int^{\\infty}_t f(u) du$\n\nAs it is linked to the distribution function we can therefore say\n\n$f(t) = -S'(t)$\n\n### Hazard Function\n\nThe risk of death at time $t$ given survival to time $t$. Or the instantaenous risk of death at time $t$\n\n$h(t) = \\frac{f(t)}{S(t)}$\n\n### Integrated Hazard Function\n\n$H(t) = \\int^{t}_0 h(u) du = -log(S(t))$\n\nSo\n\n$S(t) = e^{\\left(-H(t)\\right)}$\n\nand\n\n$f(t) = h(t)e^{\\left(-H(t)\\right)}$\n\n\n\n### Limits worth knowing\n\n$f(t) = lim_{h \\rightarrow 0 } \\frac{P(t < T < t+h)}{h}$\n\nand\n\n$h(t) = lim_{h \\rightarrow 0 } \\frac{P(t \\leq T < t+h | T \\geq t)}{h}$\n\n## Chapter 2 - Distributions\n\n### Exponential\n\nThe only distribution with a constant hazard function.\n\n$T_i \\sim Exp(\\lambda, \\gamma)$\n\nProperty| equation\n-----|-----\n$f(t)$|$\\lambda e^{-\\lambda t}$\n$F(t)$|$1 - e^{-\\lambda t}$\n$S(t)$|$e^{-\\lambda t}$\n$h(t)$ | $\\lambda$\n\n\n### Weibull\n\nThe weibull can vary by implementation `survreg` uses the following implementation\n\n$T_i \\sim Weibull(\\lambda, \\gamma)$\n\nProperties should be given, **TO BE VERIFIED**\n\nIn this course:\n\n- $\\lambda$ is the shape\n- $\\gamma$ is the rate\n\nIt is extremely flexible, but can become unstable near $\\gamma = 1$. From $\\gamma$ we know the following:\n\n- $\\gamma = 1$ - Constant Hazard, becomes the exponential\n- $\\gamma > 1$ - Hazard INCREASES with time\n- $\\gamma < 1$ - Hazard DECREASES with time\n\n\n**TODO - Add plot to get a feel for various hazrds, etc**\n\n\n::: {.cell}\n\n```{.python .cell-code}\nfrom scipy import stats\nimport numpy as np\nimport matplotlib.pyplot as plt\n\nxs = np.arange(0,100,0.1)\ns_t = stats.expon(0,10).sf(xs)\nf_t = stats.expon(0,10).pdf(xs)\nplt.plot(xs,s_t)\n```\n\n::: {.cell-output-display}\n![](survival_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n\n## Chapter 2 - Life Tables\n\nSee notes - Two example type to be practiced exhaustively (No loss and loss to follow up)\n\nLifetables tabulate death rates over a period of time. They are useful non-parametric summaries and help to inform which parametric models might be sensible. \n\nIn the loss to follow up we assume in this course that:\n\n- $p_x$ and $q_x$ are constant over a time period, this is reasonable if short\n- We assume those who withdraw have the same probability of dieing as those who don't\n- We assume withdrawls are evenly spaced through the year\n\n## Chapter 2 - Kaplan-Meier\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrnorm(1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1.380991\n```\n:::\n:::\n\n\n\n## Chapter 3  - Two Sample\n\nKaplan-Meier is just a visual aid, we need to look at tests\n\n### Log Rank Test\n\nNon-parametric.\n\n\n$$ H_0 : S_1(t) = S_2(t)$$\n\n$$ H_A : S_1(t) \\neq S_2(t)$$ \n\n$H_A$ is for some $t$\n\nSteps:\n\n1) Create a table\n2) create an $i$ column for 1,2,..n\n3) create a $t_i$ column and list all the times of deaths only\n4) Create an $r_{1,i}$ and $r_{2,i}$ for at risk (At risk for a time includes those who died at that time and all future censorees)\n5) Sum  $r_{1,i}$ and $r_{2,i}$ to get $r_i$\n6) Create an $d_{1,i}$ and $d_{2,i}$ for death counts at the times\n7) Sum the deaths to get $d_i$\n8) Sum down death column to get observed $O_1$ and $O_2$\n9) Calc $e_{1,i} = (\\frac{r_{1,i}}{r_i})d_i$ and $e_{2,i}$\n10) Sum the $e_{1,i}$ and $e_{2,i}$ to get $E_1$ and $E_2$\n11) Calculate using below equation\n\n$$ LR = \\frac{(O_1 - E_1)^2}{E_1} + \\frac{(O_2 - E_2)^2}{E_2} \\sim \\chi^2_{1}$$\n\n\n\n### Parametric \n\n\n",
    "supporting": [
      "survival_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}